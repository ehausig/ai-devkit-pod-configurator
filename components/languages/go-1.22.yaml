id: GO_1_22
name: Go 1.22
group: go-version
requires: []
description: Go programming language version 1.22
version: "1.22.0"
installation:
  dockerfile: |
    RUN ARCH=$(dpkg --print-architecture) && \
        GO_ARCH=${ARCH} && \
        if [ "${ARCH}" = "arm64" ]; then \
            GO_ARCH="arm64"; \
        elif [ "${ARCH}" = "amd64" ]; then \
            GO_ARCH="amd64"; \
        fi && \
        wget -q https://go.dev/dl/go1.22.0.linux-${GO_ARCH}.tar.gz && \
        tar -C /usr/local -xzf go1.22.0.linux-${GO_ARCH}.tar.gz && \
        rm go1.22.0.linux-${GO_ARCH}.tar.gz && \
        echo 'export PATH=/usr/local/go/bin:$PATH' >> /etc/profile.d/go.sh
  env:
    - GOPATH=/home/claude/go
    - PATH=/usr/local/go/bin:$PATH
  nexus_config: |
    if [ -n "$GOPROXY" ]; then \
        echo "export GOPROXY=$GOPROXY" >> /etc/profile.d/go.sh && \
        echo "export GOPRIVATE=" >> /etc/profile.d/go.sh && \
        echo "export GONOSUMDB=" >> /etc/profile.d/go.sh; \
    fi
  test_command: go version
entrypoint_setup: |
  # Go 1.22 specific setup
  echo "Setting up Go 1.22 environment..."
  
  # Create Go workspace directory
  mkdir -p /home/devuser/go/{bin,src,pkg}
  
  # Add Go environment to bashrc
  if ! grep -q "Go environment" "$BASHRC" 2>/dev/null; then
      echo '' >> "$BASHRC"
      echo '# Go environment' >> "$BASHRC"
      echo 'export GOPATH="$HOME/go"' >> "$BASHRC"
      echo 'export PATH="/usr/local/go/bin:$GOPATH/bin:$PATH"' >> "$BASHRC"
      # Add proxy settings if configured
      if [ -n "$GOPROXY" ]; then
          echo "export GOPROXY=\"$GOPROXY\"" >> "$BASHRC"
          echo 'export GOPRIVATE=""' >> "$BASHRC"
          echo 'export GONOSUMDB=""' >> "$BASHRC"
      fi
  fi
  
  # Ensure proper ownership
  chown -R devuser:devuser /home/devuser/go 2>/dev/null || true
memory_content: |
  #### Go 1.22
  
  **What's New**:
  - Range over integers: `for i := range 10 { }`
  - Enhanced routing patterns in `net/http`
  - Improved performance (2-4% faster)
  
  **Project Management**:
  - Create module: `go mod init example.com/myapp`
  - Get dependencies: `go get ./...`
  - Tidy modules: `go mod tidy`
  - Build with vendor: `go build -mod=vendor`
  
  **Unit Testing**:
  ```go
  func TestFunction(t *testing.T) {
      result := Function()
      if result != expected {
          t.Errorf("got %v, want %v", result, expected)
      }
  }
  ```
  - Run tests: `go test ./...`
  - Coverage: `go test -cover ./...`
  - Race detector: `go test -race ./...`
  - Verbose: `go test -v ./...`
  
  **Integration Testing**:
  - Use `testify` for assertions: `go get github.com/stretchr/testify`
  - Table-driven tests for comprehensive coverage
  - Mock interfaces, not implementations
  
  **Build Options**:
  - Static binary: `CGO_ENABLED=0 go build`
  - Cross-compile: `GOOS=windows GOARCH=amd64 go build`
  - Optimize size: `go build -ldflags="-s -w"`
  
  **API Development Pattern**:
  ```go
  // Quick HTTP server with Go 1.22 enhanced routing
  http.HandleFunc("GET /api/users/{id}", getUserHandler)
  http.HandleFunc("POST /api/users", createUserHandler)
  http.ListenAndServe(":8080", nil)
  ```
  
  **Development Workflow**:
  - Hot reload: `go install github.com/cosmtrek/air@latest && air`
  - Format code: `go fmt ./...`
  - Vet code: `go vet ./...`
  
  **Common Issues**:
  - Module not found: Run `go mod tidy` to sync dependencies
  - Version conflicts: Check with `go mod graph`
  - Clear cache: `go clean -modcache`
