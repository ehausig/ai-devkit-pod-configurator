id: JAVA_21_ADOPTIUM
name: Java 21 (Eclipse Adoptium)
group: java-version
requires: []
description: Eclipse Adoptium (formerly AdoptOpenJDK) Temurin 21
installation:
  dockerfile: |
    # Pass Nexus configuration to this build stage
    ARG USE_NEXUS_APT
    ARG NEXUS_APT_URL
    RUN export DEBIAN_FRONTEND=noninteractive && \
        apt-get update && \
        apt-get install -y wget apt-transport-https gnupg && \
        mkdir -p /etc/apt/keyrings && \
        wget -qO - https://packages.adoptium.net/artifactory/api/gpg/key/public | tee /etc/apt/keyrings/adoptium.asc > /dev/null && \
        if [ -n "$USE_NEXUS_APT" ] && [ -n "$NEXUS_APT_URL" ]; then \
            echo "deb [signed-by=/etc/apt/keyrings/adoptium.asc] ${NEXUS_APT_URL}/repository/adoptium-apt-proxy $(awk -F= '/^VERSION_CODENAME/{print$2}' /etc/os-release) main" | tee /etc/apt/sources.list.d/adoptium.list; \
        else \
            echo "deb [signed-by=/etc/apt/keyrings/adoptium.asc] https://packages.adoptium.net/artifactory/deb $(awk -F= '/^VERSION_CODENAME/{print$2}' /etc/os-release) main" | tee /etc/apt/sources.list.d/adoptium.list; \
        fi && \
        apt-get update && \
        apt-get install -y temurin-21-jdk && \
        rm -rf /var/lib/apt/lists/*
  env:
    - JAVA_HOME=/usr/lib/jvm/temurin-21-jdk-${TARGETARCH}
  test_command: java -version
memory_content: |
  #### Java 21 (Eclipse Adoptium Temurin) - Latest LTS
  
  **Environment**:
  - Java version: `java -version`
  - JAVA_HOME: Pre-configured at `/usr/lib/jvm/temurin-21-jdk-${TARGETARCH}`
  
  **Java 21 Highlights**:
  - Virtual threads: `Thread.ofVirtual().start(() -> {})` for massive concurrency
  - Pattern matching: Complete with record patterns in switch
  - Sequenced collections: `List.reversed()`, `Map.firstEntry()`
  - String templates (preview): Better string interpolation
  
  **Performance Tips**:
  - Use G1GC (default): Balanced for most workloads
  - For low latency: `java -XX:+UseZGC MyApp`
  - For throughput: `java -XX:+UseParallelGC MyApp`
